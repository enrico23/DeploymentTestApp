trigger:
  batch: true
  branches:
    include:
    - main

pool:
  name: DemoPool
  vmImage: 'windows-2022'

variables:
  runEndToEnd: ${{ne(variables['Build.Reason'], 'PullRequest')}}

# ---------------------------------

stages:
- stage: BuildStage
  displayName:  üèó Build Stage
  dependsOn: []

  jobs:
  # this will create an error
  - job: HelloWorld
    displayName: Hello World
    steps:
      - task: PowerShell@2
      name: preprare_file_list_pr_comments
      displayName: 'Prepare file list for PR comments'
      inputs:
        pwsh: true
        targetType: "inline"
        script: |
          echo "Getting list of files changed."
          $commitHash = $(Build.SourceVersion)
          $prFiles=$(git diff-tree --no-commit-id --name-status -r $(Build.SourceVersion))
          $temp=$prFiles -split ' '
          $prFilesCount=$temp.Length
          echo "Total changed $prFilesCount files $commitHash"

