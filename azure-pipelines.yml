trigger:
  batch: true
  branches:
    include:
    - main
pr:
    - main
pool:
  name: DemoPool
  vmImage: 'windows-2022'

variables:
  runEndToEnd: ${{ne(variables['Build.Reason'], 'PullRequest')}}
  pullRequestFileListPath: $(Agent.TempDirectory)\pullRequestFileList.json
  isPullRequest: ${{eq(variables['Build.Reason'], 'PullRequest')}}
# ---------------------------------

stages:
- stage: BuildStage
  displayName:  üèó Build Stage
  dependsOn: []

  jobs:
    - job: HelloWorld
      condition: eq(variables['Build.Reason'], 'PullRequest')
      displayName: Hello World
      steps:
        - task: PowerShell@2
          inputs:
            targetType: 'inline'
            script: |
              echo $(variables.isPullRequest)
              echo "Total changed $count files"
              echo "Commit hash $(Build.SourceVersion)"
              echo "PullRequest Target branch: $(System.PullRequest.TargetBranch)"
              $files=$(git diff-tree --no-commit-id --name-only -r $(Build.SourceVersion))
              $temp=$files -split ' '
              $count=$temp.Length
         